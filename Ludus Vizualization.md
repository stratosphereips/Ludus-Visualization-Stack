<h1 id="ludus-visualization-stack">Ludus Visualization Stack</h1>
<p>The Ludus Visualization Stack uses the <a href="https://www.elastic.co/">Elastic stack</a> to visualize data from gathered from <a href="https://github.com/stratosphereips/Ludus">Ludus</a>. Data from the Ludus database is backed up in the process.</p>
<h2 id="structure">Structure</h2>
<p>ludus_viz.py :</p>
<ol>
<li>gets user and database information from command line</li>
<li>starts filebeat</li>
<li>calls <code>get_data.py</code> to transfer data from psql database and copy it to mysql</li>
<li>calls <code>txt2json.py</code> to get last updated row in table</li>
<li>calls <code>break_up.py</code> to break up big json into multiple small jsons usable in Elastic stack</li>
</ol>
<div class="mermaid"><svg xmlns="http://www.w3.org/2000/svg" id="mermaid-svg-lwK1hRMdNf60HkOa" width="100%" style="max-width: 515.01171875px;" viewBox="0 0 515.01171875 1150"><g transform="translate(-12, -12)"><g class="output"><g class="clusters"><g class="cluster" id="subGraph0" transform="translate(429.01171875,984)" style="opacity: 1;"><rect width="180" height="340" x="-90" y="-170"></rect><g class="label"><g transform="translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"></div></foreignObject></g></g><text x="0" y="-156" fill="black" stroke="none" id="mermaid-svg-lwK1hRMdNf60HkOaText" style="text-anchor: middle;">docker-elk</text></g></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M458.8258463541667,66L499.5078125,91L499.5078125,139L499.5078125,187L499.5078125,235L499.5078125,283L499.5078125,331L499.5078125,379L499.5078125,427L499.5078125,475L499.5078125,523L499.5078125,571L499.5078125,619L499.5078125,667L462.7910970052083,692" marker-end="url(#arrowhead30960)" style="stroke: #333; fill:none;stroke-width:2px;stroke-dasharray:3;"></path><defs><marker id="arrowhead30960" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M368.9140625,57.41792045784803L246.66796875,91L206.25048828125,116" marker-end="url(#arrowhead30961)" style="stroke: #333; fill:none;stroke-width:2px;stroke-dasharray:3;"></path><defs><marker id="arrowhead30961" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M382.8685709635417,66L340.98828125,91L340.98828125,116" marker-end="url(#arrowhead30962)" style="stroke: #333; fill:none;stroke-width:2px;stroke-dasharray:3;"></path><defs><marker id="arrowhead30962" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M432.275146484375,66L444.09765625,91L444.09765625,139L444.09765625,187L444.09765625,235L444.09765625,283L444.09765625,331L444.09765625,379L444.09765625,427L444.09765625,475L412.5892740885417,500" marker-end="url(#arrowhead30963)" style="stroke: #333; fill:none;stroke-width:2px;stroke-dasharray:3;"></path><defs><marker id="arrowhead30963" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M159.06640625,66L159.06640625,91L164.27473958333334,116" marker-end="url(#arrowhead30964)" style="fill:none"></path><defs><marker id="arrowhead30964" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M131.37508138020834,162L90.40625,187L90.40625,212" marker-end="url(#arrowhead30965)" style="fill:none"></path><defs><marker id="arrowhead30965" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M206.75773111979166,162L247.7265625,187L247.7265625,212" marker-end="url(#arrowhead30966)" style="fill:none"></path><defs><marker id="arrowhead30966" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M247.7265625,258L247.7265625,283L247.7265625,308" marker-end="url(#arrowhead30967)" style="fill:none"></path><defs><marker id="arrowhead30967" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M247.7265625,354L247.7265625,379L247.7265625,404" marker-end="url(#arrowhead30968)" style="fill:none"></path><defs><marker id="arrowhead30968" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M247.7265625,450L247.7265625,475L331.1015625,504.45354185832565" marker-end="url(#arrowhead30969)" style="fill:none"></path><defs><marker id="arrowhead30969" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M383.6015625,546L383.6015625,571L383.6015625,596" marker-end="url(#arrowhead30970)" style="fill:none"></path><defs><marker id="arrowhead30970" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M383.6015625,642L383.6015625,667L407.252685546875,692" marker-end="url(#arrowhead30971)" style="fill:none"></path><defs><marker id="arrowhead30971" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M429.01171875,738L429.01171875,776L429.01171875,814L429.01171875,839" marker-end="url(#arrowhead30972)" style="fill:none"></path><defs><marker id="arrowhead30972" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M429.01171875,885L429.01171875,923L429.01171875,961" marker-end="url(#arrowhead30973)" style="fill:none"></path><defs><marker id="arrowhead30973" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M429.01171875,1007L429.01171875,1045L429.01171875,1083" marker-end="url(#arrowhead30974)" style="fill:none"></path><defs><marker id="arrowhead30974" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(429.01171875,776)" style="opacity: 1;"><g transform="translate(-52,-13)" class="label"><foreignObject width="104" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">localhost:5000</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(429.01171875,923)" style="opacity: 1;"><g transform="translate(-52,-13)" class="label"><foreignObject width="104" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">localhost:9200</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(429.01171875,1045)" style="opacity: 1;"><g transform="translate(-52,-13)" class="label"><foreignObject width="104" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">localhost:5601</span></div></foreignObject></g></g></g><g class="nodes"><g class="node" id="logstash" transform="translate(429.01171875,862)" style="opacity: 1;"><rect rx="0" ry="0" x="-38.8046875" y="-23" width="77.609375" height="46" style="fill:#1ED4F8;stroke:#000;"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-28.8046875,-13)"><foreignObject width="57.609375" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">logstash</div></foreignObject></g></g></g><g class="node" id="elasticsearch" transform="translate(429.01171875,984)" style="opacity: 1;"><rect rx="0" ry="0" x="-55" y="-23" width="110" height="46" style="fill:#1ED4F8;stroke:#000;"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-45,-13)"><foreignObject width="90" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">elasticsearch</div></foreignObject></g></g></g><g class="node" id="kibana" transform="translate(429.01171875,1106)" style="opacity: 1;"><rect rx="0" ry="0" x="-32.8828125" y="-23" width="65.765625" height="46" style="fill:#1ED4F8;stroke:#000;"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-22.8828125,-13)"><foreignObject width="45.765625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">kibana</div></foreignObject></g></g></g><g class="node" id="SDB" transform="translate(159.06640625,43)" style="opacity: 1;"><rect rx="5" ry="5" x="-72.71875" y="-23" width="145.4375" height="46" style="fill:#4EEA0B;stroke:#000;"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-62.71875,-13)"><foreignObject width="125.4375" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">sentinel_database</div></foreignObject></g></g></g><g class="node" id="BDB" transform="translate(90.40625,235)" style="opacity: 1;"><rect rx="5" ry="5" x="-70.40625" y="-23" width="140.8125" height="46" style="fill:#4EEA0B;stroke:#000;"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-60.40625,-13)"><foreignObject width="120.8125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">backup_database</div></foreignObject></g></g></g><g class="node" id="filebeat" transform="translate(429.01171875,715)" style="opacity: 1;"><rect rx="0" ry="0" x="-36.2421875" y="-23" width="72.484375" height="46" style="fill:#1ED4F8;stroke:#000;"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-26.2421875,-13)"><foreignObject width="52.484375" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">filebeat</div></foreignObject></g></g></g><g class="node" id="data.txt" transform="translate(247.7265625,235)" style="opacity: 1;"><rect rx="0" ry="0" x="-36.9140625" y="-23" width="73.828125" height="46" style="fill:#F4FB05;stroke:#000;"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-26.9140625,-13)"><foreignObject width="53.828125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">data.txt</div></foreignObject></g></g></g><g class="node" id="data.json" transform="translate(247.7265625,427)" style="opacity: 1;"><rect rx="0" ry="0" x="-41.578125" y="-23" width="83.15625" height="46" style="fill:#F4FB05;stroke:#000;"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-31.578125,-13)"><foreignObject width="63.15625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">data.json</div></foreignObject></g></g></g><g class="node" id="brk-data.json" transform="translate(383.6015625,619)" style="opacity: 1;"><rect rx="0" ry="0" x="-55.8203125" y="-23" width="111.640625" height="46" style="fill:#F4FB05;stroke:#000;"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-45.8203125,-13)"><foreignObject width="91.640625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">brk-data.json</div></foreignObject></g></g></g><g class="node" id="ludus_viz.py" transform="translate(421.3984375,43)" style="opacity: 1;"><rect rx="0" ry="0" x="-52.484375" y="-23" width="104.96875" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-42.484375,-13)"><foreignObject width="84.96875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">ludus_viz.py</div></foreignObject></g></g></g><g class="node" id="get_data.py" transform="translate(169.06640625,139)" style="opacity: 1;"><rect rx="0" ry="0" x="-50.53125" y="-23" width="101.0625" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-40.53125,-13)"><foreignObject width="81.0625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">get_data.py</div></foreignObject></g></g></g><g class="node" id="txt2json_data.py" transform="translate(340.98828125,139)" style="opacity: 1;"><rect rx="0" ry="0" x="-68.109375" y="-23" width="136.21875" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-58.109375,-13)"><foreignObject width="116.21875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">txt2json_data.py</div></foreignObject></g></g></g><g class="node" id="break_up.py" transform="translate(383.6015625,523)" style="opacity: 1;"><rect rx="0" ry="0" x="-52.5" y="-23" width="105" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-42.5,-13)"><foreignObject width="85" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">break_up.py</div></foreignObject></g></g></g><g class="node" id="txt2json.py" transform="translate(247.7265625,331)" style="opacity: 1;"><rect rx="0" ry="0" x="-49.140625" y="-23" width="98.28125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-39.140625,-13)"><foreignObject width="78.28125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">txt2json.py</div></foreignObject></g></g></g></g></g></g></svg></div>
<h2 id="starting-and-stopping">Starting and Stopping</h2>
<p>Run</p>
<pre><code>python3 ludus_viz.py --host HOST --db_name DB_NAME --db_username DB_USER --db_password DB_PASS --local_dir DIRECTORY --backup_db_name BACKUP_DB_NAME --backup_db_username BACKUP_DB_USER --backup_db_password BACKUP_DB_PASS --backup_time TIME_IN_MINUTES
</code></pre>
<p>Run continuously</p>
<pre><code>nohup python3 ludus_viz.py --host HOST --db_name DB_NAME --db_username DB_USER --db_password DB_PASS --local_dir DIRECTORY --backup_db_name BACKUP_DB_NAME --backup_db_username BACKUP_DB_USER --backup_db_password BACKUP_DB_PASS --backup_time TIME_IN_MINUTES &amp;
</code></pre>
<p>Stop</p>
<p>find process id (PID):</p>
<pre><code>ps ax | grep ludus_viz.py
</code></pre>
<p>end process:</p>
<pre><code>kill PID
</code></pre>
<h2 id="configuration">Configuration</h2>
<p>In <code>/filbeat</code></p>
<ul>
<li>filebeat: filebeat.yml</li>
</ul>
<p>In <code>/docker-elk</code></p>
<ul>
<li><code>docker-compose.yml</code></li>
<li>logstash: <code>config/logstash.yml</code>, <code>pipeline/logstash.conf</code>, <code>Dockerfile</code></li>
<li>elasticsearch: <code>config/elasticsearch.yml</code>, <code>Dockerfile</code></li>
<li>kibana: <code>config/kibana.yml</code>, <code>Dockerfile</code></li>
</ul>
<h4 id="updating-the-stack">Updating the stack</h4>
<ol>
<li>Change ELK_VERSION=7.0.1 in <code>.env</code> file</li>
<li>Run <code>docker-compose -f /docker-elk build</code> in terminal</li>
</ol>
<h2 id="ludus-data-format">Ludus data format</h2>
<p>Postgres data table:</p>
<pre><code>   CREATE TABLE ludus_jsons (
   json_id serial PRIMARY KEY,
   record_id varchar NOT NULL,
   router_id varchar NOT NULL,
   complete_json json NOT NULL,
   date_stored date
   );
</code></pre>
<p>Mysql data table:</p>
<pre><code>    CREATE TABLE ludus_jsons (
    json_id SERIAL,
    record_id VARCHAR(40) NOT NULL,
    router_id VARCHAR(40) NOT NULL,
    complete_json VARCHAR(10000) NOT NULL,
    date_stored DATE,
    PRIMARY KEY ( json_id )
    );
</code></pre>
<p><code>complete_json</code> structure after breakup:</p>
<p>FLOWS JSON<br>
pkts_to_client: #<br>
pkts_to_server: #<br>
bytes_to_client: #<br>
bytes_to_server: #<br>
sport: #<br>
dport: #<br>
protocol: upd/tcp<br>
status: honeypot/production/closed<br>
alert: 0/1<br>
src_ip: ip address<br>
id: str<br>
ts: #<br>
tw_end: DATE<br>
tw_start: DATE</p>
<p>ALERTS JSON<br>
‘# Severity 1’: #<br>
‘# Severity 2’: #<br>
‘# Severity 3’: #<br>
‘# Severity 4’: #<br>
‘# Uniq Signatures’: #</p>
<p>‘Alerts Categories’ JSON<br>
Attempted Administrator Privilege Gain: #<br>
Potential Corporate Privacy Violation: #<br>
Attempt to Login By a Default Username and Password: #<br>
Executable Code was Detected: #<br>
A TCP Connection was Detected: #<br>
Attempted Information Leak: #<br>
Misc activity: #<br>
Not Suspicious Traffic: #<br>
Misc Attack: #<br>
Detection of a Network Scan: #	<br>
A Network Trojan was detected: #</p>
<p>‘Alerts/DstBClassNet’ JSON<br>
‘Alerts/DstPort’ JSON<br>
‘Alerts/SrcBClassNet’ JSON<br>
‘Alerts/SrcPort’ JSON<br>
‘Per SrcPort’ JSON<br>
‘bytes_per_port’ JSON<br>
‘flows’ JSON<br>
‘packets_per_port’ JSON</p>
<h2 id="kibana-visualizations">Kibana Visualizations</h2>
<pre><code>dashboards
</code></pre>

